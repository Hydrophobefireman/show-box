String.prototype.trunc=function(t){return this.length>t?this.substr(0,t-1)+"...":this};var dynamic_inp=document.getElementById("dynamic_inp"),inp_res=document.getElementById("inp-results");function make_req(t,e){var n=t.value;check_inp(n)&&e.send(n)}function check_inp(t){return 0!==t.replace(/([^\w]|_)/g,"").length}function __img(t,e){if(!t.src){var n=window.URL||window.webkitURL,i=new Request(e);t.onload=function(t){n.revokeObjectURL(t.target.src)},fetch(i).then(function(t){return t.blob()}).then(function(t){return n.createObjectURL(t)}).then(function(e){t.src=e,t.style.backgroundColor=""})}}(()=>{if(window.WebSocket){var t=("https:"===window.location.protocol?"wss://":"ws://")+window.location.host+"/suggestqueries",e=new WebSocket(t);dynamic_inp.oninput=function(){inp_res.innerHTML="",make_req(this,e)},e.onopen=function(t){console.log(t)},e.onmessage=function(t){_msg=t.data;var e=JSON.parse(_msg),n=e.data;console.log("Response Cached:"+e.Cached);for(var i=0;i<n.length;i++){var o=n[i],r=document.createElement("div"),s=document.createElement("span"),c=document.createElement("img");c.id=o.id,r.setAttribute("data-id",o.thumb),r.setAttribute("data-im",o.id),r.onclick=function(){window.location="/movie/"+this.getAttribute("data-im")+"/movie"},r.style.cursor="pointer",r.style.listStyle="none",r.style.width="80%",r.onmouseenter=function(){__img(document.getElementById(this.getAttribute("data-im")),this.getAttribute("data-id"))},document.ontouchstart=function(){__img(document.getElementById(this.getAttribute("data-im")),this.getAttribute("data-id"))},r.appendChild(c),r.appendChild(s),r.style.margin="auto",c.style.height="80px",c.style.margin="10px",s.innerHTML=o.movie,inp_res.appendChild(r),r.style.textAlign="left",r.style.border="2px solid #e3e3e3",r.style.borderRadius="5px"}}}})();